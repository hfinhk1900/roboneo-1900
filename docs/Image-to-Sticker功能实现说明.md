# Image to Sticker åŠŸèƒ½å®ç°è¯´æ˜

## ğŸ“‹ ç›®å½•
- [åŠŸèƒ½æ¦‚è¿°](#åŠŸèƒ½æ¦‚è¿°)
- [æŠ€æœ¯æ¶æ„è®¾è®¡](#æŠ€æœ¯æ¶æ„è®¾è®¡)
- [APIä¾›åº”å•†é€‚é…å™¨](#apiä¾›åº”å•†é€‚é…å™¨)
- [å‰ç«¯äº¤äº’æµç¨‹](#å‰ç«¯äº¤äº’æµç¨‹)
- [åç«¯APIè®¾è®¡](#åç«¯apiè®¾è®¡)
- [Creditsç³»ç»Ÿé›†æˆ](#creditsç³»ç»Ÿé›†æˆ)
- [å®æ–½ä»»åŠ¡æ¸…å•](#å®æ–½ä»»åŠ¡æ¸…å•)
- [æµ‹è¯•éªŒè¯è®¡åˆ’](#æµ‹è¯•éªŒè¯è®¡åˆ’)

---

## åŠŸèƒ½æ¦‚è¿°

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½
Image to Stickeræ˜¯RoboNeo Artçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå…è®¸ç”¨æˆ·ä¸Šä¼ ä»»æ„ç…§ç‰‡å¹¶è½¬æ¢ä¸ºå„ç§é£æ ¼çš„è´´çº¸ã€‚

### ğŸ’¡ ç”¨æˆ·ä½“éªŒæµç¨‹
1. **ä¸Šä¼ å›¾ç‰‡**: æ”¯æŒJPEG/PNGæ ¼å¼ï¼Œâ‰¤5MB
2. **é€‰æ‹©é£æ ¼**: iOSè´´çº¸ã€åƒç´ è‰ºæœ¯ã€ä¹é«˜ç§¯æœ¨ã€å²åŠªæ¯”é£æ ¼ç­‰
3. **ç”Ÿæˆé¢„è§ˆ**: å®æ—¶æ˜¾ç¤ºå¤„ç†è¿›åº¦
4. **ä¸‹è½½ç»“æœ**: è·å¾—é€æ˜èƒŒæ™¯çš„PNGè´´çº¸

### ğŸ¨ æ”¯æŒçš„è´´çº¸é£æ ¼
| é£æ ¼ç±»å‹ | æŠ€æœ¯å®ç° | Creditsæ¶ˆè€— | ç‰¹ç‚¹ |
|---------|----------|-------------|------|
| **iOS Sticker** | OpenAI DALL-E 3 ç¼–è¾‘ | 10 Credits | è‹¹æœé£æ ¼ï¼Œåœ†æ¶¦è¾¹ç¼˜ |
| **Pixel Art** | åƒç´ åŒ–promptå¤„ç† | 10 Credits | 8ä½æ¸¸æˆé£æ ¼ |
| **LEGO Style** | ä¹é«˜ç§¯æœ¨é£æ ¼è½¬æ¢ | 10 Credits | ç§¯æœ¨è´¨æ„Ÿï¼Œæ˜äº®è‰²å½© |
| **Snoopy Style** | å¡é€šåŒ–å¤„ç† | 10 Credits | ç®€çº¦çº¿æ¡ï¼Œå¯çˆ±é£æ ¼ |

---

## æŠ€æœ¯æ¶æ„è®¾è®¡

### ğŸ—ï¸ æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend UI   â”‚    â”‚   Next.js API   â”‚    â”‚  AI Providers   â”‚
â”‚                 â”‚    â”‚    Routes       â”‚    â”‚                 â”‚
â”‚ - å›¾ç‰‡ä¸Šä¼       â”‚â”€â”€â”€â”€â”‚                 â”‚â”€â”€â”€â”€â”‚ - Laozhang API  â”‚
â”‚ - é£æ ¼é€‰æ‹©      â”‚    â”‚ - å‚æ•°éªŒè¯      â”‚    â”‚ - OpenAI Direct â”‚
â”‚ - è¿›åº¦æ˜¾ç¤º      â”‚    â”‚ - Creditsæ£€æŸ¥   â”‚    â”‚ - Future APIs   â”‚
â”‚ - ç»“æœå±•ç¤º      â”‚    â”‚ - ä»»åŠ¡ç®¡ç†      â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚   File Storage  â”‚
                       â”‚                 â”‚
                       â”‚ - ä¸Šä¼ æ–‡ä»¶ç¼“å­˜  â”‚
                       â”‚ - ç»“æœæ–‡ä»¶å­˜å‚¨  â”‚
                       â”‚ - CDNåˆ†å‘       â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“ é¡¹ç›®ç›®å½•ç»“æ„

```
src/
â”œâ”€ ai/
â”‚  â”œâ”€ image/
â”‚  â”‚  â”œâ”€ providers/           # AIä¾›åº”å•†é€‚é…å™¨
â”‚  â”‚  â”‚  â”œâ”€ laozhang.ts      # è€å¼ APIé€‚é…å™¨
â”‚  â”‚  â”‚  â”œâ”€ openai.ts        # OpenAIç›´æ¥è°ƒç”¨
â”‚  â”‚  â”‚  â”œâ”€ base.ts          # åŸºç¡€é€‚é…å™¨æ¥å£
â”‚  â”‚  â”‚  â””â”€ index.ts         # ä¾›åº”å•†é€‰æ‹©å™¨
â”‚  â”‚  â”œâ”€ processors/          # å›¾ç‰‡å¤„ç†å™¨
â”‚  â”‚  â”‚  â”œâ”€ upload.ts        # æ–‡ä»¶ä¸Šä¼ å¤„ç†
â”‚  â”‚  â”‚  â”œâ”€ style.ts         # é£æ ¼å‚æ•°å¤„ç†
â”‚  â”‚  â”‚  â””â”€ output.ts        # ç»“æœå¤„ç†
â”‚  â”‚  â”œâ”€ types/              # ç±»å‹å®šä¹‰
â”‚  â”‚  â”‚  â”œâ”€ provider.ts      # ä¾›åº”å•†æ¥å£ç±»å‹
â”‚  â”‚  â”‚  â”œâ”€ style.ts         # é£æ ¼é…ç½®ç±»å‹
â”‚  â”‚  â”‚  â””â”€ task.ts          # ä»»åŠ¡çŠ¶æ€ç±»å‹
â”‚  â”‚  â””â”€ utils/              # å·¥å…·å‡½æ•°
â”‚  â”‚     â”œâ”€ image-helpers.ts # å›¾ç‰‡å¤„ç†å·¥å…·
â”‚  â”‚     â””â”€ prompt-builder.ts # æç¤ºè¯æ„å»º
â”‚  â””â”€ storage/               # æ–‡ä»¶å­˜å‚¨
â”‚     â”œâ”€ upload.ts           # ä¸Šä¼ æ–‡ä»¶ç®¡ç†
â”‚     â””â”€ result.ts           # ç»“æœæ–‡ä»¶ç®¡ç†
â”œâ”€ app/
â”‚  â””â”€ api/
â”‚     â”œâ”€ image-to-sticker/   # ä¸»è¦APIç«¯ç‚¹
â”‚     â”‚  â””â”€ route.ts
â”‚     â”œâ”€ upload-image/       # å›¾ç‰‡ä¸Šä¼ ç«¯ç‚¹
â”‚     â”‚  â””â”€ route.ts
â”‚     â””â”€ sticker-result/     # ç»“æœè·å–ç«¯ç‚¹
â”‚        â””â”€ [taskId]/
â”‚           â””â”€ route.ts
â””â”€ components/
   â””â”€ ai/
      â””â”€ image/
         â”œâ”€ ImageUploader.tsx    # å›¾ç‰‡ä¸Šä¼ ç»„ä»¶
         â”œâ”€ StyleSelector.tsx    # é£æ ¼é€‰æ‹©ç»„ä»¶
         â”œâ”€ GenerationStatus.tsx # ç”ŸæˆçŠ¶æ€ç»„ä»¶
         â””â”€ ResultDisplay.tsx    # ç»“æœå±•ç¤ºç»„ä»¶
```

---

## APIä¾›åº”å•†é€‚é…å™¨

### ğŸ”Œ åŸºç¡€æ¥å£è®¾è®¡

```typescript
// src/ai/image/types/provider.ts
export interface ImageToStickerProvider {
  name: string;
  supportedStyles: StickerStyle[];
  maxFileSize: number;
  supportedFormats: string[];

  // æ ¸å¿ƒæ–¹æ³•
  generateSticker(params: StickerGenerationParams): Promise<StickerResult>;
  checkStatus(taskId: string): Promise<TaskStatus>;
  getResult(taskId: string): Promise<StickerResult>;
}

export interface StickerGenerationParams {
  imageFile: Buffer;
  imageFormat: string;
  style: StickerStyle;
  prompt?: string;
  userId: string;
}

export interface StickerResult {
  taskId: string;
  status: 'pending' | 'processing' | 'completed' | 'failed';
  resultUrl?: string;
  resultBuffer?: Buffer;
  seed?: number;
  processingTime?: number;
  error?: string;
}
```

### ğŸ”§ Laozhang APIé€‚é…å™¨

```typescript
// src/ai/image/providers/laozhang.ts
export class LaozhangProvider implements ImageToStickerProvider {
  name = 'laozhang';
  apiKey: string;
  baseUrl = 'https://api.laozhang.ai/v1';

  supportedStyles = [
    StickerStyle.IOS_STICKER,
    StickerStyle.PIXEL_ART,
    StickerStyle.LEGO_STYLE,
    StickerStyle.SNOOPY_STYLE
  ];

  async generateSticker(params: StickerGenerationParams): Promise<StickerResult> {
    // æ„å»ºé£æ ¼ç‰¹å®šçš„prompt
    const stylePrompt = this.buildStylePrompt(params.style);
    const finalPrompt = `${stylePrompt}. Convert the uploaded image to this style while maintaining the main subject.`;

    // ä½¿ç”¨ /v1/images/edits ç«¯ç‚¹
    const formData = new FormData();
    formData.append('image', new Blob([params.imageFile]), 'input.png');
    formData.append('model', 'gpt-image-1');
    formData.append('prompt', finalPrompt);
    formData.append('n', '1');
    formData.append('size', '1024x1024');

    const response = await fetch(`${this.baseUrl}/images/edits`, {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${this.apiKey}`
      },
      body: formData
    });

    return this.processResponse(response);
  }

  private buildStylePrompt(style: StickerStyle): string {
    const stylePrompts = {
      [StickerStyle.IOS_STICKER]: 'iOS emoji sticker style with clean edges, vibrant colors, and transparent background',
      [StickerStyle.PIXEL_ART]: '8-bit pixel art style with blocky edges and retro gaming colors',
      [StickerStyle.LEGO_STYLE]: 'LEGO minifigure style with plastic texture and bright colors',
      [StickerStyle.SNOOPY_STYLE]: 'Snoopy cartoon style with simple lines and cute expression'
    };

    return stylePrompts[style] || stylePrompts[StickerStyle.IOS_STICKER];
  }
}
```

### ğŸ¯ ä¾›åº”å•†é€‰æ‹©å™¨

```typescript
// src/ai/image/providers/index.ts
export class ProviderManager {
  private providers: Map<string, ImageToStickerProvider>;

  constructor() {
    this.providers = new Map();
    this.registerProvider(new LaozhangProvider());
    // æœªæ¥å¯ä»¥æ·»åŠ æ›´å¤šä¾›åº”å•†
    // this.registerProvider(new OpenAIDirectProvider());
    // this.registerProvider(new ReplicateProvider());
  }

  async selectBestProvider(style: StickerStyle, userPlan: UserPlan): Promise<ImageToStickerProvider> {
    // é€‰æ‹©é€»è¾‘ï¼š
    // 1. æ£€æŸ¥ä¾›åº”å•†æ˜¯å¦æ”¯æŒæŒ‡å®šé£æ ¼
    // 2. æ ¹æ®ç”¨æˆ·è®¡åˆ’é€‰æ‹©åˆé€‚çš„ä¾›åº”å•†
    // 3. è€ƒè™‘æˆæœ¬å’Œè´¨é‡å¹³è¡¡

    const availableProviders = Array.from(this.providers.values())
      .filter(provider => provider.supportedStyles.includes(style));

    if (availableProviders.length === 0) {
      throw new Error(`No provider supports style: ${style}`);
    }

    // ä¼˜å…ˆé€‰æ‹©Laozhangï¼ˆæ€§ä»·æ¯”é«˜ï¼‰
    return availableProviders.find(p => p.name === 'laozhang') || availableProviders[0];
  }
}
```

---

## å‰ç«¯äº¤äº’æµç¨‹

### ğŸ¨ Sticker ç”Ÿæˆå™¨é›†æˆ

```typescript
// src/components/blocks/sticker/sticker-generator.tsx (æ›´æ–°ç°æœ‰ç»„ä»¶)
export default function HeroSection() {
  const [uploadedImage, setUploadedImage] = useState<File | null>(null);
  const [selectedStyle, setSelectedStyle] = useState<StickerStyle>(StickerStyle.IOS_STICKER);
  const [generationStatus, setGenerationStatus] = useState<GenerationStatus>('idle');
  const [result, setResult] = useState<StickerResult | null>(null);

  const { generateSticker, isLoading } = useImageToSticker();

  const handleGenerate = async () => {
    if (!uploadedImage) return;

    try {
      setGenerationStatus('processing');
      const result = await generateSticker({
        imageFile: uploadedImage,
        style: selectedStyle
      });

      setResult(result);
      setGenerationStatus('completed');
    } catch (error) {
      setGenerationStatus('failed');
      console.error('Generation failed:', error);
    }
  };

  return (
    <main className="hero-section">
      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
        {/* å·¦ä¾§ï¼šä¸Šä¼ å’Œé…ç½® */}
        <div className="upload-section">
          <ImageUploader
            onImageSelect={setUploadedImage}
            maxSize={5 * 1024 * 1024} // 5MB
          />

          <StyleSelector
            selectedStyle={selectedStyle}
            onStyleChange={setSelectedStyle}
            disabled={isLoading}
          />

          <GenerateButton
            onClick={handleGenerate}
            disabled={!uploadedImage || isLoading}
            loading={isLoading}
          />
        </div>

        {/* å³ä¾§ï¼šé¢„è§ˆå’Œç»“æœ */}
        <div className="preview-section">
          <GenerationStatus status={generationStatus} />

          {result && (
            <ResultDisplay
              result={result}
              originalImage={uploadedImage}
            />
          )}
        </div>
      </div>
    </main>
  );
}
```

### ğŸ–¼ï¸ æ ¸å¿ƒå‰ç«¯Hook

```typescript
// src/ai/image/hooks/use-image-to-sticker.ts
export function useImageToSticker() {
  const [isLoading, setIsLoading] = useState(false);
  const [progress, setProgress] = useState(0);

  const generateSticker = async (params: {
    imageFile: File;
    style: StickerStyle;
  }): Promise<StickerResult> => {
    setIsLoading(true);
    setProgress(0);

    try {
      // 1. æ£€æŸ¥ç”¨æˆ·Credits
      const creditsCheck = await fetch('/api/user/credits');
      const credits = await creditsCheck.json();

      if (credits.balance < 10) {
        throw new Error('Insufficient credits');
      }

      // 2. ä¸Šä¼ å›¾ç‰‡
      setProgress(20);
      const uploadData = new FormData();
      uploadData.append('image', params.imageFile);

      const uploadResponse = await fetch('/api/upload-image', {
        method: 'POST',
        body: uploadData
      });

      const { uploadId } = await uploadResponse.json();

      // 3. å¼€å§‹ç”Ÿæˆ
      setProgress(40);
      const generateResponse = await fetch('/api/image-to-sticker', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          uploadId,
          style: params.style
        })
      });

      const { taskId } = await generateResponse.json();

      // 4. è½®è¯¢ç»“æœ
      setProgress(60);
      return await pollForResult(taskId, setProgress);

    } finally {
      setIsLoading(false);
      setProgress(0);
    }
  };

  return { generateSticker, isLoading, progress };
}
```

---

## åç«¯APIè®¾è®¡

### ğŸ“¤ å›¾ç‰‡ä¸Šä¼ API

```typescript
// src/app/api/upload-image/route.ts
export async function POST(request: Request) {
  try {
    const session = await getSession();
    if (!session?.user) {
      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });
    }

    const formData = await request.formData();
    const imageFile = formData.get('image') as File;

    // éªŒè¯æ–‡ä»¶
    const validation = validateImageFile(imageFile);
    if (!validation.valid) {
      return NextResponse.json({ error: validation.error }, { status: 400 });
    }

    // ä¸´æ—¶å­˜å‚¨æ–‡ä»¶
    const uploadId = generateUploadId();
    const tempPath = await saveTemporaryFile(imageFile, uploadId);

    return NextResponse.json({
      uploadId,
      fileName: imageFile.name,
      fileSize: imageFile.size,
      expiresAt: new Date(Date.now() + 30 * 60 * 1000) // 30åˆ†é’Ÿåè¿‡æœŸ
    });

  } catch (error) {
    return NextResponse.json({ error: 'Upload failed' }, { status: 500 });
  }
}
```

### ğŸ¨ å›¾ç‰‡è½¬è´´çº¸API

```typescript
// src/app/api/image-to-sticker/route.ts
export async function POST(request: Request) {
  try {
    const session = await getSession();
    if (!session?.user) {
      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });
    }

    const { uploadId, style } = await request.json();

    // 1. æ£€æŸ¥Credits
    const creditsManager = new CreditsManager();
    const canGenerate = await creditsManager.canUserGenerate(session.user.id, 'laozhang', 'standard');

    if (!canGenerate.canGenerate) {
      return NextResponse.json({
        error: 'Insufficient credits',
        required: canGenerate.cost,
        current: canGenerate.remainingAfter + canGenerate.cost
      }, { status: 402 });
    }

    // 2. è·å–ä¸Šä¼ çš„æ–‡ä»¶
    const imageBuffer = await getTemporaryFile(uploadId);
    if (!imageBuffer) {
      return NextResponse.json({ error: 'Upload not found or expired' }, { status: 404 });
    }

    // 3. é€‰æ‹©åˆé€‚çš„ä¾›åº”å•†
    const providerManager = new ProviderManager();
    const provider = await providerManager.selectBestProvider(style, session.user.planType);

    // 4. å¼€å§‹ç”Ÿæˆä»»åŠ¡
    const taskId = generateTaskId();
    const generationParams = {
      imageFile: imageBuffer,
      imageFormat: 'png',
      style,
      userId: session.user.id
    };

    // å¼‚æ­¥å¤„ç†ç”Ÿæˆä»»åŠ¡
    processGenerationTask(taskId, provider, generationParams, creditsManager);

    return NextResponse.json({
      taskId,
      status: 'pending',
      estimatedTime: 15000 // 15ç§’é¢„ä¼°
    });

  } catch (error) {
    return NextResponse.json({ error: 'Generation failed' }, { status: 500 });
  }
}
```

### ğŸ“Š ä»»åŠ¡çŠ¶æ€æŸ¥è¯¢API

```typescript
// src/app/api/sticker-result/[taskId]/route.ts
export async function GET(
  request: Request,
  { params }: { params: { taskId: string } }
) {
  try {
    const session = await getSession();
    if (!session?.user) {
      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });
    }

    const { taskId } = params;
    const taskStatus = await getTaskStatus(taskId);

    if (!taskStatus || taskStatus.userId !== session.user.id) {
      return NextResponse.json({ error: 'Task not found' }, { status: 404 });
    }

    return NextResponse.json({
      taskId,
      status: taskStatus.status,
      progress: taskStatus.progress,
      resultUrl: taskStatus.resultUrl,
      error: taskStatus.error,
      processingTime: taskStatus.processingTime
    });

  } catch (error) {
    return NextResponse.json({ error: 'Query failed' }, { status: 500 });
  }
}
```

---

## Creditsç³»ç»Ÿé›†æˆ

### ğŸ’³ Creditsæ¶ˆè€—è§„åˆ™

| é£æ ¼ç±»å‹ | Creditsæ¶ˆè€— | å¤„ç†æ—¶é—´ | è´¨é‡ç­‰çº§ |
|---------|-------------|----------|----------|
| iOS Sticker | 10 Credits | ~15ç§’ | é«˜è´¨é‡ |
| Pixel Art | 10 Credits | ~15ç§’ | é«˜è´¨é‡ |
| LEGO Style | 10 Credits | ~15ç§’ | é«˜è´¨é‡ |
| Snoopy Style | 10 Credits | ~15ç§’ | é«˜è´¨é‡ |

### ğŸ”„ Creditså¤„ç†æµç¨‹

```typescript
// ç”Ÿæˆå‰æ£€æŸ¥
const canGenerate = await creditsManager.canUserGenerate(userId, provider, quality);

// ç”ŸæˆæˆåŠŸåæ‰£å‡
if (generationSuccess) {
  await creditsManager.deductCredits(userId, creditsCost, taskId);
}

// ç”Ÿæˆå¤±è´¥æ—¶é€€æ¬¾
if (generationFailed) {
  await creditsManager.refundCredits(userId, creditsCost, taskId, 'Generation failed');
}
```

---

## å®æ–½ä»»åŠ¡æ¸…å•

### ğŸ—ï¸ Phase 1: åŸºç¡€æ¶æ„ (ç¬¬1å‘¨)

#### åç«¯åŸºç¡€è®¾æ–½
- [ ] **åˆ›å»ºé¡¹ç›®ç›®å½•ç»“æ„**
  - [ ] `src/ai/image/providers/` ç›®å½•
  - [ ] `src/ai/image/types/` ç±»å‹å®šä¹‰
  - [ ] `src/ai/image/utils/` å·¥å…·å‡½æ•°

- [ ] **åŸºç¡€ç±»å‹å®šä¹‰**
  - [ ] `ImageToStickerProvider` æ¥å£
  - [ ] `StickerGenerationParams` ç±»å‹
  - [ ] `StickerResult` ç±»å‹
  - [ ] `StickerStyle` æšä¸¾å®šä¹‰

- [ ] **Laozhang APIé€‚é…å™¨**
  - [ ] å®ç°åŸºç¡€çš„ `LaozhangProvider` ç±»
  - [ ] é…ç½®APIå¯†é’¥å’Œç«¯ç‚¹
  - [ ] å®ç° `generateSticker()` æ–¹æ³•
  - [ ] æ·»åŠ é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶

#### å‰ç«¯åŸºç¡€ç»„ä»¶
- [ ] **ImageUploaderç»„ä»¶**
  - [ ] æ‹–æ‹½ä¸Šä¼ ç•Œé¢
  - [ ] æ–‡ä»¶æ ¼å¼å’Œå¤§å°éªŒè¯
  - [ ] å›¾ç‰‡é¢„è§ˆåŠŸèƒ½

- [ ] **StyleSelectorç»„ä»¶**
  - [ ] é£æ ¼é€‰é¡¹ç•Œé¢
  - [ ] é£æ ¼é¢„è§ˆå›¾æ ‡
  - [ ] é€‰ä¸­çŠ¶æ€ç®¡ç†

### ğŸ”§ Phase 2: æ ¸å¿ƒåŠŸèƒ½ (ç¬¬2å‘¨)

#### APIç«¯ç‚¹å®ç°
- [ ] **å›¾ç‰‡ä¸Šä¼ API** (`/api/upload-image`)
  - [ ] æ–‡ä»¶æ¥æ”¶å’ŒéªŒè¯
  - [ ] ä¸´æ—¶æ–‡ä»¶å­˜å‚¨
  - [ ] è¿‡æœŸæ¸…ç†æœºåˆ¶

- [ ] **å›¾ç‰‡è½¬è´´çº¸API** (`/api/image-to-sticker`)
  - [ ] å‚æ•°éªŒè¯å’Œå¤„ç†
  - [ ] Creditsæ£€æŸ¥å’Œæ‰£å‡
  - [ ] å¼‚æ­¥ä»»åŠ¡åˆ›å»º

- [ ] **ç»“æœæŸ¥è¯¢API** (`/api/sticker-result/[taskId]`)
  - [ ] ä»»åŠ¡çŠ¶æ€æŸ¥è¯¢
  - [ ] ç»“æœæ–‡ä»¶ä¸‹è½½
  - [ ] æƒé™éªŒè¯

#### å‰ç«¯äº¤äº’é€»è¾‘
- [ ] **useImageToSticker Hook**
  - [ ] å®Œæ•´çš„ç”Ÿæˆæµç¨‹
  - [ ] è¿›åº¦çŠ¶æ€ç®¡ç†
  - [ ] é”™è¯¯å¤„ç†

- [ ] **GenerationStatusç»„ä»¶**
  - [ ] å®æ—¶è¿›åº¦æ˜¾ç¤º
  - [ ] çŠ¶æ€åŠ¨ç”»æ•ˆæœ
  - [ ] é”™è¯¯ä¿¡æ¯å±•ç¤º

### ğŸ¨ Phase 3: ç”¨æˆ·ä½“éªŒä¼˜åŒ– (ç¬¬3å‘¨)

#### ç•Œé¢å®Œå–„
- [ ] **ResultDisplayç»„ä»¶**
  - [ ] ç»“æœå›¾ç‰‡å±•ç¤º
  - [ ] åŸå›¾å¯¹æ¯”åŠŸèƒ½
  - [ ] ä¸‹è½½å’Œåˆ†äº«æŒ‰é’®

- [ ] **Creditsé›†æˆ**
  - [ ] å®æ—¶ä½™é¢æ˜¾ç¤º
  - [ ] æ¶ˆè€—é¢„ä¼°æç¤º
  - [ ] ä½™é¢ä¸è¶³å¤„ç†

#### æ€§èƒ½ä¼˜åŒ–
- [ ] **æ–‡ä»¶å¤„ç†ä¼˜åŒ–**
  - [ ] å›¾ç‰‡å‹ç¼©å’Œæ ¼å¼è½¬æ¢
  - [ ] ç¼“å­˜ç­–ç•¥å®ç°
  - [ ] CDNé›†æˆ

- [ ] **å¼‚æ­¥ä»»åŠ¡ä¼˜åŒ–**
  - [ ] ä»»åŠ¡é˜Ÿåˆ—ç®¡ç†
  - [ ] å¤±è´¥é‡è¯•æœºåˆ¶
  - [ ] è¶…æ—¶å¤„ç†

### ğŸ§ª Phase 4: æµ‹è¯•å’Œéƒ¨ç½² (ç¬¬4å‘¨)

#### åŠŸèƒ½æµ‹è¯•
- [ ] **å•å…ƒæµ‹è¯•**
  - [ ] APIé€‚é…å™¨æµ‹è¯•
  - [ ] å·¥å…·å‡½æ•°æµ‹è¯•
  - [ ] ç»„ä»¶æ¸²æŸ“æµ‹è¯•

- [ ] **é›†æˆæµ‹è¯•**
  - [ ] å®Œæ•´ç”Ÿæˆæµç¨‹æµ‹è¯•
  - [ ] é”™è¯¯åœºæ™¯æµ‹è¯•
  - [ ] æ€§èƒ½å‹åŠ›æµ‹è¯•

#### éƒ¨ç½²å‡†å¤‡
- [ ] **ç¯å¢ƒé…ç½®**
  - [ ] ç”Ÿäº§ç¯å¢ƒAPIå¯†é’¥
  - [ ] æ–‡ä»¶å­˜å‚¨é…ç½®
  - [ ] ç›‘æ§å’Œæ—¥å¿—

- [ ] **ç”¨æˆ·æ–‡æ¡£**
  - [ ] åŠŸèƒ½ä½¿ç”¨æŒ‡å—
  - [ ] FAQå¸¸è§é—®é¢˜
  - [ ] æ•…éšœæ’é™¤æ–‡æ¡£

---

## æµ‹è¯•éªŒè¯è®¡åˆ’

### ğŸ§ª æµ‹è¯•ç”¨ä¾‹è®¾è®¡

#### åŠŸèƒ½æµ‹è¯•
```
1. å›¾ç‰‡ä¸Šä¼ æµ‹è¯•
   - æ”¯æŒæ ¼å¼ï¼šJPEG, PNG âœ“
   - æ–‡ä»¶å¤§å°é™åˆ¶ï¼š5MB âœ“
   - æ— æ•ˆæ–‡ä»¶æ‹’ç» âœ“

2. é£æ ¼è½¬æ¢æµ‹è¯•
   - iOSè´´çº¸é£æ ¼ âœ“
   - åƒç´ è‰ºæœ¯é£æ ¼ âœ“
   - ä¹é«˜ç§¯æœ¨é£æ ¼ âœ“
   - å²åŠªæ¯”å¡é€šé£æ ¼ âœ“

3. Creditsç³»ç»Ÿæµ‹è¯•
   - ä½™é¢æ£€æŸ¥ âœ“
   - æ¶ˆè€—æ‰£å‡ âœ“
   - å¤±è´¥é€€æ¬¾ âœ“
```

#### æ€§èƒ½æµ‹è¯•
- **å“åº”æ—¶é—´**: ç›®æ ‡15ç§’å†…å®Œæˆç”Ÿæˆ
- **å¹¶å‘å¤„ç†**: æ”¯æŒ10ä¸ªå¹¶å‘è¯·æ±‚
- **å¤±è´¥ç‡**: ä½äº5%çš„å¤±è´¥ç‡

#### ç”¨æˆ·éªŒæ”¶æµ‹è¯•
- **æ˜“ç”¨æ€§**: 3æ­¥å®Œæˆæ“ä½œ
- **ç»“æœè´¨é‡**: 90%ç”¨æˆ·æ»¡æ„åº¦
- **ç¨³å®šæ€§**: 99.5%å¯ç”¨æ€§

### ğŸ“Š ç›‘æ§æŒ‡æ ‡

```typescript
const monitoringMetrics = {
  // ä¸šåŠ¡æŒ‡æ ‡
  daily_generations: 0,
  success_rate: 0.95,
  avg_processing_time: 15000, // æ¯«ç§’
  user_satisfaction: 0.9,

  // æŠ€æœ¯æŒ‡æ ‡
  api_response_time: 500, // æ¯«ç§’
  file_upload_success_rate: 0.99,
  credits_accuracy: 1.0,

  // æˆæœ¬æŒ‡æ ‡
  cost_per_generation: 0.1, // ç¾å…ƒ
  provider_performance: {
    laozhang: { success_rate: 0.95, avg_time: 15000 }
  }
};
```

---

## ğŸ“ˆ åç»­æ‰©å±•è®¡åˆ’

### ğŸ”® åŠŸèƒ½æ‰©å±•
- **æ‰¹é‡å¤„ç†**: ä¸€æ¬¡ä¸Šä¼ å¤šå¼ å›¾ç‰‡
- **è‡ªå®šä¹‰é£æ ¼**: ç”¨æˆ·è®­ç»ƒä¸ªäººé£æ ¼
- **é«˜çº§ç¼–è¾‘**: æ‰‹åŠ¨è°ƒæ•´è´´çº¸è¾¹ç¼˜
- **ç¤¾åŒºåˆ†äº«**: è´´çº¸ä½œå“ç¤¾åŒº

### ğŸ¤– æŠ€æœ¯æ‰©å±•
- **æ›´å¤šä¾›åº”å•†**: Midjourney, Stable Diffusion
- **è¾¹ç¼˜è®¡ç®—**: æœ¬åœ°GPUåŠ é€Ÿ
- **æ™ºèƒ½æ¨è**: åŸºäºå›¾ç‰‡å†…å®¹æ¨èé£æ ¼
- **å®æ—¶é¢„è§ˆ**: WebGLå®æ—¶é£æ ¼é¢„è§ˆ

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0
**åˆ›å»ºæ—¥æœŸ**: 2025-08-02
**è´Ÿè´£å›¢é˜Ÿ**: AIåŠŸèƒ½å¼€å‘ç»„

**å…³é”®è”ç³»äºº**:
- æŠ€æœ¯è´Ÿè´£äºº: å¾…æŒ‡å®š
- APIä¾›åº”å•†è”ç³»: laozhangæŠ€æœ¯æ”¯æŒ
- æµ‹è¯•è´Ÿè´£äºº: å¾…æŒ‡å®š

---

## ğŸ”— ç›¸å…³èµ„æº

- [Laozhang APIæ–‡æ¡£](https://apiai.apifox.cn/api-288595533)
- [OpenAIå›¾åƒç”Ÿæˆæ–‡æ¡£](https://platform.openai.com/docs/guides/image-generation)
- [Creditsç®¡ç†ç³»ç»Ÿè¯´æ˜](./Creditsç®¡ç†è¯´æ˜.md)
- [APIä¾›åº”å•†é€‚é…è§„èŒƒ](å¾…åˆ›å»º)
- [å‰ç«¯ç»„ä»¶è®¾è®¡è§„èŒƒ](å¾…åˆ›å»º)
